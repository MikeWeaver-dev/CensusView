#Adding variable names for Tract level
Tractdatacleaning <- Tractrawdata %>%
filter (variable == Variablesforanalysis[Variableindex]) %>%
select(estimate, GEOID) %>%
st_set_geometry(NULL)
colnames(Tractdatacleaning)[1] <- Variablename[Variableindex]
Tractdata <- merge(Tractdatacleaning, Tractdata, by="GEOID")
Variableindex = Variableindex + 1
}
#one new calculation
Statedata <- Statedata %>%
mutate('Percent with Bachelor Degrees' = 'Percent with Bachelor Degrees' / Households)
View(Statedata)
Statedata <- Statedata %>%
mutate(`Percent with Bachelor Degrees` = `Percent with Bachelor Degrees` / Households)
Countydata <- Countydata %>%
mutate(`Percent with Bachelor Degrees` = `Percent with Bachelor Degrees` / Households)
Tractdata <- Tractdata %>%
mutate(`Percent with Bachelor Degrees` = `Percent with Bachelor Degrees` / Households)
Statedata <- st_as_sf(Statedata, sf_column_name = "geometry")
Statedata <- st_transform(Statedata, 4326)
Countydata <- st_as_sf(Countydata, sf_column_name = "geometry")
Countydata <- st_transform(Countydata, 4326)
Tractdata <- st_as_sf(Tractdata, sf_column_name = "geometry")
Tractdata <- st_transform(Tractdata, 4326)
assign(paste0("State",Year),Statedata)
assign(paste0("County",Year),Countydata)
assign(paste0("Tract",Year),Tractdata)
rm(Staterawdata, Statedata, Statedatacleaning, Countyrawdata, Countydata, Countydatacleaning, Tractrawdata, Tractdata, Tractdatacleaning)
#don't edit this part
Year <- Startyear
#Looping Through Years
#You can edit these two variables to change the years shown
Startyear <- 2023
Endyear <- 2023
Yearsavailable <- c(2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023)
#don't edit this part
Year <- Startyear
while (Endyear >= Year) {
source(paste0(getwd(),"/Defining Variables.R"))
source(paste0(getwd(),"/Data Collection.R"))
source(paste0(getwd(),"/Data Cleaning.R"))
Year = Year + 1
}
gc()
#Looping Through Years
#You can edit these two variables to change the years shown
Startyear <- 2023
Endyear <- 2023
Yearsavailable <- c(2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023)
#don't edit this part
Year <- Startyear
while (Endyear >= Year) {
source(paste0(getwd(),"/Defining Variables.R"))
source(paste0(getwd(),"/Data Collection.R"))
source(paste0(getwd(),"/Data Cleaning.R"))
Year = Year + 1
}
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
View(Tract2023)
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
install.packages("shinyWidgets")
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
#You can edit these two variables to change the years shown
Startyear <- 2015
gc()
#Looping Through Years
#You can edit these two variables to change the years shown
Startyear <- 2015
Endyear <- 2023
Yearsavailable <- c(2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023)
#don't edit this part
Year <- Startyear
while (Endyear >= Year) {
source(paste0(getwd(),"/Defining Variables.R"))
source(paste0(getwd(),"/Data Collection.R"))
source(paste0(getwd(),"/Data Cleaning.R"))
Year = Year + 1
}
library (tidyverse)
library (sf)
library (leaflet)
library (shiny)
library (shinythemes)
library (DT)
library (bslib)
library(shinyjs)
#shinyapp UI
ui <- navbarPage(title = "Mike Weaver App",  theme = shinytheme("sandstone"),  # shinythemes::themeSelector(), #
tags$head(tags$style(HTML("
.btn-darkcyan, .btn-darkcyan:focus {
background-color:#6bc2c2!important; border-color:#6bc2c2!important; color:#fff!important;
}
.btn-darkcyan:hover, .btn-darkcyan.active, .open>.dropdown-toggle.btn-darkcyan {
background-color:#0bbaba!important; border-color:#0bbaba!important; color:#fff!important;
}
"))),
tabsetPanel(
tabPanel("Data Mapping",
shinyjs::useShinyjs(),
titlePanel(
tags$h2("Census Data Mapping",
style = "margin: 10px 5px 20px 15px;"
)),
tags$h4("Select Inputs Below!",
style = "color: DarkCyan; margin: 10px 5px 15px 15px;"
),
sidebarLayout(
sidebarPanel(
p("", style = "margin-bottom: -10px;"),
h4("Choose Variable & Geography to Analyze"),
p("", style = "margin-bottom: 25px;"),
shinyWidgets::radioGroupButtons(
inputId  = "Analysismode",
label    = "Select Type of Analysis",
choices  = c("Point-in-Time" = "point", "Change-over-Time" = "change"),
selected = "point",
individual = TRUE,        # <-- separate buttons (not touching)
#direction = "horizontal",
#justified = TRUE,     # stretches to full width (nice in sidebars)
size = "sm",
status = "darkcyan",   # color
checkIcon = list(yes = icon("check"))
),
tags$head(tags$style(HTML("
/* spacing + rounded corners for shinyWidgets radioGroupButtons */
.radio-group-buttons .btn.radiobtn {
border-radius: 10px !important;   /* slightly rounded */
margin-right: 8px;                /* slight gap between buttons */
margin-bottom: 6px;                /* slight gap between buttons */
}
.radio-group-buttons .btn.radiobtn:last-child { margin-right: 0; }
"))),
p("", style = "margin-bottom: 8px;"),
selectInput(inputId ="Geography",
label = "Choose a Geography",
choices = c("State", "County", "Tract"),
selected = "State"
),
# Only show this panel if the plot type is a histogram
conditionalPanel(
condition = "input.Geography == 'Tract'",
selectInput(inputId ="State",
label = "Choose a State to Analyze",
choices = Statenames,
selected = "Alabama"
)),
conditionalPanel(
condition = "input.Analysismode == 'point'",
selectInput(inputId ="Year2",
label = "Choose a Year to Analyze",
choices = Yearsavailable,
selected = "2023"
)
),
conditionalPanel(
condition = "input.Analysismode == 'change'",
selectInput(inputId ="Year1",
label = "Choose Start Year for Analysis",
choices = Yearsavailable,
selected = "2015"
)
),
conditionalPanel(
condition = "input.Analysismode == 'change'",
selectInput(inputId ="Year2",
label = "Choose End Year for Analysis",
choices = Yearsavailable,
selected = "2023"
)
),
selectInput(inputId ="Variable",
label = "Choose a Variable to Analyze",
choices = Variablename,
selected = "Population"
),
p("", style = "margin-bottom: 35px;"),
actionButton(inputId = "Button",
label = "Generate Map",
styleclass = "",
size = "",
block = F,
icon = NULL,
icon.library = c("bootstrap", "font awesome")
),
p("", style = "margin-bottom: 5px;"),
shinyjs::hidden(
div(id = "loading_note", class = "text-warning", "Loading…")
)
),
mainPanel(
div(class = "panel panel-default",
div(class = "panel-heading", "Interactive Map"),
div(class = "panel-body",
leafletOutput("Map", height = 400),
verbatimTextOutput("clicked")
)
),
div(class = "panel panel-primary",
div(class = "panel-heading", "Data Table"),
div(class = "panel-body"
)
)
)
)
),
# This tab showcases your other apps with three themed panels in a row
tabPanel(
"Other Apps",
# ---- Styles: panels + link color fix + subtle polish ----
tags$head(tags$style(HTML("
.panel { border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.06); border-width:1px; margin-bottom:20px; }
.panel .panel-body { min-height: 120px; } /* tweak to taste */
/* DEFAULT (warm neutral) */
.panel-default { border-color:#a39c96; }
.panel-default > .panel-heading { background:#a39c96; border-color:#a39c96; color:#FFFFFF; font-weight:600; }
.panel-default > .panel-body { background:#F5F1EC; color:#3F3A37; }
.panel-default > .panel-heading a,
.panel-default > .panel-heading a:hover,
.panel-default > .panel-heading a:focus { color:#FFFFFF; text-decoration:none; }
/* PRIMARY (dark cyan) */
.panel-primary { border-color:#008B8B; }
.panel-primary > .panel-heading { background:#008B8B; border-color:#008B8B; color:#FFFFFF; font-weight:600; }
.panel-primary > .panel-body { background:#E6F7F7; color:#0A3F3F; }
.panel-primary > .panel-heading a,
.panel-primary > .panel-heading a:hover,
.panel-primary > .panel-heading a:focus { color:#FFFFFF; text-decoration:none; }
/* INFO (minty) */
.panel-info { border-color:#20C997; }
.panel-info > .panel-heading { background:#20C997; border-color:#20C997; color:#FFFFFF; font-weight:600; }
.panel-info > .panel-body { background:#E9FBF6; color:#114C45; }
.panel-info > .panel-heading a,
.panel-info > .panel-heading a:hover,
.panel-info > .panel-heading a:focus { color:#FFFFFF; text-decoration:none; }
"))),
titlePanel(
tags$h2("Portfolio of Web Applications",
style = "color: DarkCyan; margin: 10px 5px 20px 15px;")
),
# ---- Responsive row: 1-up on xs, 2-up on sm, 3-up on md+ ----
fluidRow(
# col-sm-6 gives 2-up at small; add col-md-4 for 3-up at md+.
column(width = 6, class = "col-md-4",
div(class = "panel panel-primary",
div(class = "panel-heading",
tags$a(href = "https://cnn.com", "GitHub Account")),
div(class = "panel-body",
"This link takes you to Mike Weaver's GitHub account so you can see all of the source code and links for his entire portfolio")
)
),
column(width = 6, class = "col-md-4",
div(class = "panel panel-info",
div(class = "panel-heading",
tags$a(href = "https://cnn.com", "AI Assisted Playlist Generation")),
div(class = "panel-body",
"This app uses the Spotify API and GPT API to help create playlists. The user will input the vibe they are going for and the program will work with their specific liked songs and input needs to generate a personalized playlist")
)
),
# Clear the row on small screens after 2 items (prevents odd wrapping)
div(class = "clearfix visible-sm-block"),
column(width = 6, class = "col-md-4",
div(class = "panel panel-default",
div(class = "panel-heading",
tags$a(href = "https://cnn.com", "Some other cool app")),
div(class = "panel-body",
"I haven't decided what to do for the third application but I'm sure I'll get there sometime soon")
)
)
)
),
tabPanel( "Note from Developer",
titlePanel(
tags$h2("Note from Developer",
style = "color: DarkCyan; margin: 10px 5px 20px 15px;"
)),
div(class = "panel panel-default",
div(class = "panel-heading", "About this Web App"),
div(class = "panel-body",
h5("This is the first app I built for my software development portfolio. I like it because it utilizes the Census API and millions of data points, but appears very simple from the user perspective.",  style = "margin: 10px 5px 20px 0px;"),
h5("This app reminds me a lot of the coding work I would do at my last job. We routinely worked with demographic data and GIS systems to synthesize complex analysis into clear and readable maps. I often used R in my last job so I felt it a fitting starting point, though in the future I hope to publish projects leverage Python, Javascript, and AI.",  style = "margin: 10px 5px 20px 0px;"),
h5("Thanks for visiting my webpage! See more of my apps on the 'Other Apps' Tab",  style = "margin: 10px 5px 20px 0px;"),
h5("Mike Weaver",  style = "margin: 0px 5px 20px 0px;")
)
)
)
)
)
server <- function(input, output, session) {
# show the note immediately on click
observeEvent(input$Button, { shinyjs::show("loading_note") })
# base map (attach a client-side listener that pings R when vector layers are added)
output$Map <- renderLeaflet({
leaflet() %>%
addTiles() %>%
setView(lng = -98.5795, lat = 39.8283, zoom = 3) %>%
htmlwidgets::onRender("
function(el, x) {
var map = this;
// When any vector (L.Path) layer is added (e.g., polygons), notify Shiny:
map.on('layeradd', function(e){
if (e.layer && (e.layer instanceof L.Path)) {
Shiny.setInputValue('map_drawn', Date.now(), {priority:'event'});
}
});
}
")
})
Mapdata <- eventReactive(input$Button, {
nm <- paste0(input$Geography, input$Year2)
d  <- get(nm, inherits = TRUE)  # sf (EPSG:4326)
if (identical(input$Geography, "Tract") && "Statenames" %in% names(d)) {
d <- d[d$Statenames == input$State, , drop = FALSE]
}
d
})
# dataset built on click
observeEvent(Mapdata(), {
d   <- Mapdata()                                   # end-year sf (Year2)
key <- if ("GEOID" %in% names(d)) "GEOID" else "NAME"
nm  <- as.character(d[["NAME"]])
# Default: point-in-time values from Year2
y2 <- d[[input$Variable]]
v  <- y2
pre  <- if (input$Variable %in% c("Median Household Income","Median Home Value",
"Median Gross Rent","Income Reached by Top 5% of Earners")) " $" else " "
post <- if (input$Variable %in% c("Percent with Bachelor Degrees")) "%" else " "
legend_title <- input$Variable
# Change-over-time mode: compute percent change (Year2 vs Year1)
if (identical(input$Analysismode, "change")) {
nm1 <- paste0(input$Geography, input$Year1)
d1  <- get(nm1, inherits = TRUE)                 # start-year sf (Year1)
if (identical(input$Geography, "Tract") && "Statenames" %in% names(d1)) {
d1 <- d1[d1$Statenames == input$State, , drop = FALSE]
}
# Align Year1 rows to Year2 by key, then compute % change
y1 <- d1[[input$Variable]][ match(d[[key]], d1[[key]]) ]
v  <- ifelse(is.na(y1) | y1 == 0, NA_real_, 100 * (y2 - y1) / y1)
pre  <- ""                                       # dollars never prefix % change
post <- "%"
legend_title <- paste0(input$Variable, " (", input$Year1, "\u2192", input$Year2, ", % change)")
}
# Clean domain for palette/legend
dom <- v[is.finite(v)]   # drops NA/NaN/Inf before color/legend calc
# Palette & labels (kept the same for simplicity)
pal  <- colorQuantile(c("#f1f1f1", "#02b3b3"), domain = dom, n = 5, na.color = "transparent")
labs <- c("Bottom 20%","20th – 40th Percentile","40th – 60th Percentile","60th – 80th Percentile","Top 80%+")
leafletProxy("Map") %>%
clearGroup("choropleth") %>%
removeControl("legend") %>%
addPolygons(
data        = d,
group       = "choropleth",
fillColor   = pal(v),
color       = "#999999",
weight      = 0.25,
opacity     = 0.4,
fillOpacity = 0.5,
label       = paste0(
nm, " — ", legend_title, ": ", pre,
if (is.numeric(v)) formatC(v, format = "f", digits = if (identical(input$Analysismode, "change")) 1 else 0, big.mark = ",") else v,
post
),
highlightOptions = highlightOptions(weight = 2, color = "#444", bringToFront = TRUE)
) %>%
addLegend("bottomright",
pal       = pal,
values    = dom,
title     = legend_title,
opacity   = 0.6,
na.label  = "",
layerId   = "legend",
labFormat = function(type, cuts, p) labs
)
})
# hide the note only after the browser added the new vector layer
observeEvent(input$map_drawn, {
shinyjs::hide("loading_note")
})
}
# Run the app ----
shinyApp(ui = ui, server = server)
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
library(shiny); runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
install.packages("rmapshaper")
library(shiny); runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
install.packages("leafgl")
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
install.packages("shinybusy")
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
install.packages("shinycssloaders")
library(shinycssloaders)
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
install.packages("leaflet.extras2")
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
runApp('Web App.R')
Variablesforanalysis <- c("B01003_001", "B11015_001", "B11011_001", "B19019_001", "B01002_001","B23025_004","B08101_049", "B25109_001", "B25031_001", "B19083_001", "B19081_006", "B15003_022")
Variablename <- c("Population", "Households", "Housing Units", "Median Household Income", "Median Age","Number of Employed People", "Employees Working from Home", "Median Home Value", "Median Gross Rent", "Gini Index of Income Inequality", "Income Reached by Top 5% of Earners", "Percent with Bachelor Degrees")
VariablesinACS <- load_variables(2015, "acs1", cache = TRUE)
View(VariablesinACS)
gc()
#Looping Through Years
#You can edit these two variables to change the years shown
Startyear <- 2015
Endyear <- 2023
Yearsavailable <- c(2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023)
#don't edit this part
Year <- Startyear
while (Endyear >= Year) {
source(paste0(getwd(),"/Defining Variables.R"))
source(paste0(getwd(),"/Data Collection.R"))
source(paste0(getwd(),"/Data Cleaning.R"))
Year = Year + 1
}
runApp('Web App.R')
save.image("~/Data Mapping/2015 - 2023 Data.RData")
load("~/Data Mapping/2015 - 2023 Data.RData")
library(shiny); runApp('Web App.R')
library(shiny); runApp('Web App.R')
shiny::runApp('C:/users/miwe9/OneDrive/Documents/Data Mapping')
runApp('Web App.R')
runApp('C:/users/miwe9/OneDrive/Documents/Data Mapping')
runApp('C:/users/miwe9/OneDrive/Documents/Data Mapping')
runApp('C:/users/miwe9/OneDrive/Documents/Data Mapping')
runApp('C:/users/miwe9/OneDrive/Documents/Data Mapping')
library(shiny); runApp('Web App.R')
runApp('Web App.R')
